# Error Handling

## General Design Principles

### Relation to Exceptions

An Error is a subclass of Exception that represents a failure in CVM code execution. 

### Error Codes

All Errors are defined to have a non-nil Error Code that describes the general nature of the Error.

Error Codes SHOULD be Keywords by convention, though this is not enforced by the CVM and altrenative CVM types MAY be used.

A difference in Error Code MUST NOT affect CVM State, however it MAY be returned to Clients by Peers for informational purposes.

### Error Messages

All Errors have a Message, which may be any CVM value.

Messages SHOULD be meaningful, and human readable to facilitate debugging or appropriate notification to uses.

### No catches

Errors are **not catchable** within CVM code.

The reason for this decision is that the security and integrity of smart contracts is at risk if Errors are mishandled, and it is far safer to always abort a transaction that caused an error. In particular, smart contracts that call untrusted code may be vulnerable to exploits that deliberately trigger an Error to exploit mistakes in error handling.

As an alternative to catching Errors, CVM code SHOULD perform appropriate checks on preconditions before calling other code. If precoditions are not met, alternative handling may performed. 

## Standard Error Codes

### `:CAST`

A `:CAST` Error SHOULD be returned whenever code is passed an argument that is of the wrong Type.

### `:ARGUMENT`

## CVM Behaviour

The CVM itself is subject to additional rules on how and when it creates Errors.

Clients MAY assume that the CVM behaves consistently according to these rules, But SHOULD NOT assume that a particular Error has been generated by the CVM itself, since user code may produce similar Errors.

### Core Runtime functions

Core Runtime functions MUST return an `:ARITY` Error if an invalid number of arguments is passed to a funtion.

Otherwise, Core Runtime functions MUST return a `:CAST` Error when an argument of the wrong Type is provided.

Otherwise, Core Runtime functions MUST return a `:NOBODY` Error when an attempt is made to access an Account that does not exist.

Otherwise, Core Runtime functions MUST return an `:ARGUMENT` Error when an argument of an allowable Type is provided, but the specific value is not permitted.

Otherwise, Core Runtime functions MUST return an Error if their execution causes any CVM code to be executed that in turn causes an Error. CVM functions MAY, in certain cases, alter the Error Code or Message to provide additional information.

Otherwise, Core Runtime Functions MUST NOT return an Error.
